{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"D:/Getty-Search-Media-Results/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _asyncToGenerator = require(\"D:/Getty-Search-Media-Results/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar _classCallCheck = require(\"D:/Getty-Search-Media-Results/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"D:/Getty-Search-Media-Results/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar querystring = require(\"querystring\");\n\nvar WebHelper = require(\"./webhelper.js\");\n\nvar _accessToken = new WeakMap();\n\nvar _apiKey = new WeakMap();\n\nvar _apiSecret = new WeakMap();\n\nvar _username = new WeakMap();\n\nvar _password = new WeakMap();\n\nvar _refreshToken = new WeakMap();\n\nvar _hostName = new WeakMap();\n\nvar Credentials = /*#__PURE__*/function () {\n  function Credentials(apiKey, apiSecret, username, password, refreshToken, hostName) {\n    _classCallCheck(this, Credentials);\n\n    this.apiKey = apiKey;\n    this.apiSecret = apiSecret;\n    this.username = username;\n    this.password = password;\n    this.refreshToken = refreshToken;\n    this.hostName = hostName;\n  }\n\n  _createClass(Credentials, [{\n    key: \"apiKey\",\n    get: function get() {\n      return _apiKey.get(this);\n    },\n    set: function set(value) {\n      _apiKey.set(this, value);\n    }\n  }, {\n    key: \"accessToken\",\n    get: function get() {\n      return _accessToken.get(this);\n    },\n    set: function set(value) {\n      _accessToken.set(this, value);\n    }\n  }, {\n    key: \"apiSecret\",\n    get: function get() {\n      return _apiSecret.get(this);\n    },\n    set: function set(value) {\n      _apiSecret.set(this, value);\n    }\n  }, {\n    key: \"password\",\n    get: function get() {\n      return _password.get(this);\n    },\n    set: function set(value) {\n      _password.set(this, value);\n    }\n  }, {\n    key: \"username\",\n    get: function get() {\n      return _username.get(this);\n    },\n    set: function set(value) {\n      _username.set(this, value);\n    }\n  }, {\n    key: \"refreshToken\",\n    get: function get() {\n      return _refreshToken.get(this);\n    },\n    set: function set(value) {\n      _refreshToken.set(this, value);\n    }\n  }, {\n    key: \"hostName\",\n    get: function get() {\n      return _hostName.get(this);\n    },\n    set: function set(value) {\n      _hostName.set(this, value);\n    }\n  }, {\n    key: \"getAccessToken\",\n    value: function () {\n      var _getAccessToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var apiKey, apiSecret, username, password, accessToken, hostName, params, postData, path, self, webHelper, response, expireTime;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                apiKey = this.apiKey;\n                apiSecret = this.apiSecret;\n                username = this.username;\n                password = this.password;\n                accessToken = this.accessToken;\n                hostName = this.hostName;\n\n                if (this.shouldRefreshToken()) {\n                  _context.next = 8;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", accessToken);\n\n              case 8:\n                params = {\n                  client_id: apiKey,\n                  client_secret: apiSecret,\n                  grant_type: \"client_credentials\"\n                };\n\n                if (username && password) {\n                  params.username = username;\n                  params.password = password;\n                  params.grant_type = \"password\";\n                }\n\n                postData = querystring.stringify(params);\n                path = \"/oauth2/token\";\n                self = this;\n                _context.prev = 13;\n                webHelper = new WebHelper(self, hostName);\n                _context.next = 17;\n                return webHelper.postForm(path, postData);\n\n              case 17:\n                response = _context.sent;\n                expireTime = new Date();\n                expireTime.setSeconds(expireTime.getSeconds() + Number(response.expires_in));\n                response.expiration = expireTime;\n                self.accessToken = response;\n                return _context.abrupt(\"return\", self.accessToken);\n\n              case 25:\n                _context.prev = 25;\n                _context.t0 = _context[\"catch\"](13);\n                return _context.abrupt(\"return\", null);\n\n              case 28:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[13, 25]]);\n      }));\n\n      function getAccessToken() {\n        return _getAccessToken.apply(this, arguments);\n      }\n\n      return getAccessToken;\n    }()\n  }, {\n    key: \"refreshAccessToken\",\n    value: function () {\n      var _refreshAccessToken = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var apiKey, apiSecret, refreshToken, hostName, params, postData, path, self, webHelper, response, expireTime;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                apiKey = this.apiKey;\n                apiSecret = this.apiSecret;\n                refreshToken = this.refreshToken;\n                hostName = this.hostName;\n                params = {\n                  client_id: apiKey,\n                  client_secret: apiSecret,\n                  refresh_token: refreshToken,\n                  grant_type: \"refresh_token\"\n                };\n                postData = querystring.stringify(params);\n                path = \"/oauth2/token\";\n                self = this;\n                _context2.prev = 8;\n                webHelper = new WebHelper(self, hostName);\n                _context2.next = 12;\n                return webHelper.postForm(path, postData);\n\n              case 12:\n                response = _context2.sent;\n                expireTime = new Date();\n                expireTime.setSeconds(expireTime.getSeconds() + Number(response.expires_in));\n                response.expiration = expireTime;\n                self.accessToken = response;\n                return _context2.abrupt(\"return\", self.accessToken);\n\n              case 20:\n                _context2.prev = 20;\n                _context2.t0 = _context2[\"catch\"](8);\n                return _context2.abrupt(\"return\", null);\n\n              case 23:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[8, 20]]);\n      }));\n\n      function refreshAccessToken() {\n        return _refreshAccessToken.apply(this, arguments);\n      }\n\n      return refreshAccessToken;\n    }()\n  }, {\n    key: \"shouldRefreshToken\",\n    value: function shouldRefreshToken() {\n      var accessToken = this.accessToken;\n\n      if (accessToken && accessToken.expiration) {\n        return new Date(Date.now() - 5000) > accessToken.expiration;\n      } else {\n        return true;\n      }\n    }\n  }]);\n\n  return Credentials;\n}();\n\nmodule.exports = Credentials;","map":{"version":3,"names":["querystring","require","WebHelper","_accessToken","WeakMap","_apiKey","_apiSecret","_username","_password","_refreshToken","_hostName","Credentials","apiKey","apiSecret","username","password","refreshToken","hostName","get","value","set","accessToken","shouldRefreshToken","params","client_id","client_secret","grant_type","postData","stringify","path","self","webHelper","postForm","response","expireTime","Date","setSeconds","getSeconds","Number","expires_in","expiration","refresh_token","now","module","exports"],"sources":["D:/Getty-Search-Media-Results/node_modules/@vineetshekhawat/gettyimages-api/lib/credentials.js"],"sourcesContent":["\"use strict\";\r\n\r\nvar querystring = require(\"querystring\");\r\nvar WebHelper = require(\"./webhelper.js\");\r\n\r\nconst _accessToken = new WeakMap();\r\nconst _apiKey = new WeakMap();\r\nconst _apiSecret = new WeakMap();\r\nconst _username = new WeakMap();\r\nconst _password = new WeakMap();\r\nconst _refreshToken = new WeakMap();\r\nconst _hostName = new WeakMap();\r\n\r\nclass Credentials {\r\n    constructor(apiKey, apiSecret, username, password, refreshToken, hostName) {\r\n        this.apiKey = apiKey;\r\n        this.apiSecret = apiSecret;\r\n        this.username = username;\r\n        this.password = password;\r\n        this.refreshToken = refreshToken;\r\n        this.hostName = hostName;\r\n    }\r\n    \r\n    get apiKey() {\r\n        return _apiKey.get(this);\r\n    }\r\n    set apiKey(value) {\r\n        _apiKey.set(this,value);\r\n    }\r\n    \r\n    get accessToken() {\r\n        return _accessToken.get(this);\r\n    }    \r\n    set accessToken(value) {\r\n        _accessToken.set(this,value);\r\n    }\r\n\r\n    get apiSecret() {\r\n        return _apiSecret.get(this);\r\n    }\r\n    set apiSecret(value) {\r\n        _apiSecret.set(this,value);\r\n    }\r\n    \r\n    get password() {\r\n        return _password.get(this);\r\n    }\r\n    set password(value) {\r\n        _password.set(this,value);\r\n    }\r\n\r\n    get username() {\r\n        return _username.get(this);\r\n    }\r\n    \r\n    set username(value) {\r\n        _username.set(this,value);\r\n    }\r\n\r\n    get refreshToken() {\r\n        return _refreshToken.get(this);\r\n    }\r\n    set refreshToken(value) {\r\n        _refreshToken.set(this,value);\r\n    }\r\n    \r\n    get hostName() {\r\n        return _hostName.get(this);\r\n    }\r\n    set hostName(value) {\r\n        _hostName.set(this,value);\r\n    }\r\n    \r\n    async getAccessToken() {\r\n        var apiKey = this.apiKey;\r\n        var apiSecret = this.apiSecret;\r\n        var username = this.username;\r\n        var password = this.password;\r\n        var accessToken = this.accessToken;\r\n        var hostName = this.hostName;\r\n        \r\n        \r\n        if (!this.shouldRefreshToken()) {\r\n            return accessToken;\r\n        }\r\n\r\n        var params = {\r\n            client_id: apiKey,\r\n            client_secret: apiSecret,\r\n            grant_type: \"client_credentials\"\r\n        };\r\n\r\n        if (username && password) {\r\n            params.username = username;\r\n            params.password = password;\r\n            params.grant_type = \"password\";\r\n        }\r\n\r\n        var postData = querystring.stringify(params);\r\n        var path = \"/oauth2/token\";\r\n\r\n        var self = this;\r\n        \r\n        try {\r\n            var webHelper = new WebHelper(self, hostName);\r\n            var response = await webHelper.postForm(path, postData);\r\n            var expireTime = new Date();\r\n            expireTime.setSeconds(expireTime.getSeconds() + Number(response.expires_in));\r\n            response.expiration = expireTime;\r\n            self.accessToken = response;\r\n            \r\n            return self.accessToken;\r\n        } catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    \r\n    async refreshAccessToken() {\r\n        var apiKey = this.apiKey;\r\n        var apiSecret = this.apiSecret;\r\n        var refreshToken = this.refreshToken;\r\n        var hostName = this.hostName;\r\n        \r\n        var params = {\r\n            client_id: apiKey,\r\n            client_secret: apiSecret,\r\n            refresh_token: refreshToken,\r\n            grant_type: \"refresh_token\"\r\n        };\r\n\r\n        var postData = querystring.stringify(params);\r\n        var path = \"/oauth2/token\";\r\n\r\n        var self = this;\r\n\r\n        try {\r\n            var webHelper = new WebHelper(self, hostName);\r\n            var response = await webHelper.postForm(path, postData);\r\n            var expireTime = new Date();\r\n            expireTime.setSeconds(expireTime.getSeconds() + Number(response.expires_in));\r\n            response.expiration = expireTime;\r\n            self.accessToken = response;\r\n            \r\n            return self.accessToken;\r\n        } catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n        \r\n\r\n\r\n    shouldRefreshToken() {\r\n        var accessToken = this.accessToken;\r\n        \r\n        if (accessToken && accessToken.expiration) {\r\n            return new Date(Date.now() - 5000) > accessToken.expiration;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = Credentials;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}